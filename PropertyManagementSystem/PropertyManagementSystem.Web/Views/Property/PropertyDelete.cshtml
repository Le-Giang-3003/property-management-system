@model PropertyManagementSystem.DAL.Entities.Property

@{
    ViewData["Title"] = $"Xóa {Model.Name}";
    Layout = "_AuthLayout";
}

<div class="container mt-4">
    <!-- Warning Header -->
    <div class="text-center mb-4">
        <h1 class="text-danger">Xác nhận xóa BDS</h1>
        <p class="text-muted">Hành động này không thể hoàn tác!</p>
    </div>

    <!-- Property Card -->
    <div class="card border-danger mb-3">
        <div class="card-header bg-danger text-white">
            <h5 class="mb-0">Thông tin BDS sẽ bị xóa</h5>
        </div>
        <div class="card-body">
            <!-- Alert -->
            <div class="alert alert-warning" role="alert">
                <h5 class="alert-heading">Cảnh báo quan trọng!</h5>
                <p class="mb-0">
                    Bạn có chắc chắn muốn xóa bất động sản này?
                    Mọi dữ liệu liên quan (hợp đồng, bảo trì, ảnh) sẽ bị xóa vĩnh viễn.
                </p>
            </div>

            <!-- Property Details -->
            <div class="bg-light p-3 rounded mb-3">
                <h4 class="mb-3">@Model.Name</h4>

                <div class="row">
                    <!-- Location -->
                    <div class="col-md-6 mb-3">
                        <small class="text-muted d-block">Địa chỉ</small>
                        <strong>@Model.Address</strong>
                    </div>
                    <div class="col-md-6 mb-3">
                        <small class="text-muted d-block">Khu vực</small>
                        <strong>
                            @Model.City@(Model.District != null ? $", {Model.District}" : "")
                        </strong>
                    </div>

                    <!-- Type & Specs -->
                    <div class="col-md-6 mb-3">
                        <small class="text-muted d-block">Loại BDS</small>
                        <span class="badge badge-info">@Model.PropertyType</span>
                    </div>
                    <div class="col-md-6 mb-3">
                        <small class="text-muted d-block">Thông số</small>
                        <strong>
                            @Model.Bedrooms PN • @Model.Bathrooms PT • @Model.SquareFeet.ToString("N0") ft²
                        </strong>
                    </div>

                    <!-- Pricing -->
                    <div class="col-md-6 mb-3">
                        <small class="text-muted d-block">Giá thuê</small>
                        <h5 class="text-success mb-0">
                            @Model.RentAmount.ToString("N0") ₫/tháng
                        </h5>
                    </div>

                    <!-- Status -->
                    <div class="col-md-6 mb-3">
                        <small class="text-muted d-block">Trạng thái</small>
                        <span class="badge @GetStatusBadgeClass(Model.Status)">
                            @GetStatusDisplay(Model.Status)
                        </span>
                    </div>

                    <!-- Deposit -->
                    @if (Model.DepositAmount.HasValue)
                    {
                        <div class="col-md-6 mb-3">
                            <small class="text-muted d-block">Tiền cọc</small>
                            <strong class="text-warning">
                                @Model.DepositAmount.Value.ToString("N0") ₫
                            </strong>
                        </div>
                    }

                    <!-- Created Date -->
                    <div class="col-md-6 mb-3">
                        <small class="text-muted d-block">Ngày tạo</small>
                        <strong>@Model.CreatedAt.ToString("dd/MM/yyyy HH:mm")</strong>
                    </div>
                </div>
            </div>

            <!-- Landlord Info -->
            @if (Model.Landlord != null)
            {
                <div class="bg-light p-3 rounded mb-3">
                    <h6 class="mb-2">Chủ BDS</h6>
                    <div>
                        <strong class="d-block">@Model.Landlord.FullName</strong>
                        <small class="text-muted">@Model.Landlord.Email</small>
                    </div>
                </div>
            }

            <!-- Action Buttons -->
            <form asp-action="Delete" method="post" class="mt-4">
                <input type="hidden" asp-for="PropertyId" />

                <div class="row">
                    <div class="col-md-6 mb-2">
                        <button type="submit" class="btn btn-danger btn-block"
                                onclick="return confirm('Bạn có CHẮC CHẮN muốn xóa BDS này không?');">
                            Xác nhận xóa vĩnh viễn
                        </button>
                    </div>
                    <div class="col-md-6 mb-2">
                        <a asp-action="Index" class="btn btn-secondary btn-block">
                            Hủy bỏ
                        </a>
                    </div>
                </div>

                <div class="text-center mt-3">
                    <small class="text-muted">
                        Hoặc quay lại
                        <a asp-action="Details" asp-route-id="@Model.PropertyId">
                            xem chi tiết BDS
                        </a>
                    </small>
                </div>
            </form>
        </div>
    </div>

    <!-- Additional Warning -->
    <div class="alert alert-danger">
        <strong>Lưu ý:</strong>
        Hành động xóa này sẽ xóa tất cả dữ liệu liên quan bao gồm
        hợp đồng, yêu cầu bảo trì, lịch xem nhà, và ứng tuyển thuê.
    </div>
</div>

@functions {
    string GetStatusBadgeClass(string status)
    {
        return status switch
        {
            "Available" => "badge-success",
            "Rented" => "badge-warning",
            "Maintenance" => "badge-info",
            "Unavailable" => "badge-secondary",
            _ => "badge-secondary"
        };
    }

    string GetStatusDisplay(string status)
    {
        return status switch
        {
            "Available" => "Có sẵn",
            "Rented" => "Đã thuê",
            "Maintenance" => "Bảo trì",
            "Unavailable" => "Không khả dụng",
            _ => status
        };
    }
}
